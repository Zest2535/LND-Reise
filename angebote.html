<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Alle Angebote - LND-Reisen</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styleIndex.css">
  <link rel="stylesheet" href="animations.css">
  <style>
    body { 
      padding-top: 76px;
      background: linear-gradient(180deg, #f8f9ff 0%, #ffffff 100%);
    }
    .offer-item {
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      cursor: pointer;
      border: none;
      border-radius: 24px;
      overflow: hidden;
      background: #fff;
      box-shadow: 0 4px 20px rgba(0,0,0,0.08);
      position: relative;
      height: 600px;
      display: flex;
      flex-direction: column;
    }
    .offer-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
      opacity: 0;
      transition: opacity 0.4s;
      z-index: 1;
      pointer-events: none;
    }
    .offer-item:hover::before {
      opacity: 1;
    }
    .offer-item:hover {
      transform: translateY(-12px) scale(1.02);
      box-shadow: 0 20px 60px rgba(102, 126, 234, 0.25);
    }
    .featured-card:hover {
      transform: translateY(-16px) scale(1.03);
      box-shadow: 0 25px 70px rgba(255, 215, 0, 0.4);
    }
    .compact-card:hover {
      transform: translateY(-8px) scale(1.01);
      box-shadow: 0 15px 40px rgba(102, 126, 234, 0.2);
    }
    .wide-card:hover {
      transform: translateY(-14px) scale(1.025);
      box-shadow: 0 22px 65px rgba(102, 126, 234, 0.3);
    }
    .offer-img {
      height: 220px;
      object-fit: cover;
      width: 100%;
      transition: transform 0.6s ease;
    }
    .offer-item:hover .offer-img {
      transform: scale(1.1);
    }
    .price-badge {
      position: absolute;
      top: 15px;
      right: 15px;
      background: linear-gradient(135deg, #ff6b6b, #ee5a6f);
      color: white;
      padding: 0.6rem 1.2rem;
      border-radius: 30px;
      font-weight: 800;
      font-size: 1.3rem;
      box-shadow: 0 8px 25px rgba(238, 90, 111, 0.4);
      z-index: 2;
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    .filter-section {
      background: white;
      padding: 0;
      border-radius: 16px;
      margin-bottom: 2rem;
      box-shadow: 0 10px 40px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    .search-box-wrapper {
      background: white;
      border-radius: 16px;
      overflow: hidden;
    }
    .search-field {
      padding: 0.75rem 1rem;
      border-right: 1px solid #e9ecef;
      height: 100%;
      transition: background 0.2s;
    }
    .search-field:hover {
      background: #f8f9fa;
    }
    .search-field:last-child {
      border-right: none;
    }
    .search-field label {
      display: block;
      font-size: 0.75rem;
      font-weight: 600;
      color: #667eea;
      margin-bottom: 0.25rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .search-field .form-control,
    .search-field .form-select {
      border: 2px solid rgba(102, 126, 234, 0.2);
      padding: 0.75rem 1rem;
      font-size: 1rem;
      font-weight: 500;
      background: rgba(255, 255, 255, 0.9);
      box-shadow: 0 2px 8px rgba(102, 126, 234, 0.1);
      cursor: pointer;
      border-radius: 12px;
      transition: all 0.3s ease;
    }
    .search-field .form-control:focus,
    .search-field .form-select:focus {
      outline: none;
      box-shadow: none;
      background: transparent;
    }
    .search-field .form-select {
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%23667eea' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14L2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 1rem center;
      background-size: 18px;
      padding-right: 2.5rem;
    }

    /* General styles for all select elements */
    select {
      border: 2px solid rgba(102, 126, 234, 0.2);
      padding: 0.75rem 1rem;
      font-size: 1rem;
      font-weight: 500;
      background: rgba(255, 255, 255, 0.95);
      box-shadow: 0 2px 8px rgba(102, 126, 234, 0.1);
      border-radius: 12px;
      transition: all 0.3s ease;
      cursor: pointer;
    }
    select:focus {
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);
      background: white;
    }
    select:hover {
      border-color: rgba(102, 126, 234, 0.4);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15);
    }

    /* General styles for all options */
    option {
      padding: 1rem 1.25rem;
      font-size: 1rem;
      font-weight: 500;
      background: white;
      color: #2d3748;
      border-radius: 8px;
      transition: all 0.2s ease;
    }
    option:hover {
      background: linear-gradient(135deg, #f0f4ff, #e6f0ff);
      color: #667eea;
      font-weight: 600;
    }
    .search-field .form-select option {
      padding: 1.25rem 1.5rem;
      font-size: 1rem;
      font-weight: 500;
      background: white;
      color: #2d3748;
      border-radius: 8px;
      transition: all 0.2s ease;
    }
    .search-field .form-select option:hover {
      background: linear-gradient(135deg, #f0f4ff, #e6f0ff);
      color: #667eea;
      font-weight: 600;
    }
    .search-field-btn {
      padding: 0.75rem 1rem;
      height: 100%;
      display: flex;
      align-items: center;
    }
    .btn-search {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      border: none;
      height: 45px;
      font-size: 1.1rem;
      transition: all 0.3s;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .btn-search:hover {
      background: linear-gradient(135deg, #764ba2, #667eea);
      transform: scale(1.05);
    }
    @media (max-width: 991px) {
      .search-field {
        border-right: none;
        border-bottom: 1px solid #e9ecef;
      }
      .col-md-12:last-child .search-field {
        border-bottom: none;
      }
    }
    .results-count {
      background: linear-gradient(135deg, #ffffff 0%, #f8f9ff 100%);
      padding: 1.2rem 2rem;
      border-radius: 20px;
      margin-bottom: 2rem;
      box-shadow: 0 8px 30px rgba(102, 126, 234, 0.15);
      border: 2px solid rgba(102, 126, 234, 0.1);
    }
    .hero-header h1 {
      font-weight: 800;
      background: linear-gradient(135deg, #667eea, #764ba2);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: 0 4px 20px rgba(102, 126, 234, 0.2);
    }
    .hero-header .badge {
      font-size: 0.9rem;
      padding: 0.6rem 1.2rem;
      border-radius: 20px;
      font-weight: 600;
    }
    .offer-item .p-3 {
      position: relative;
      z-index: 2;
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }
    .offer-item h5 {
      font-weight: 700;
      color: #2d3748;
    }
    .offer-item .btn-primary {
      background: linear-gradient(135deg, #667eea, #764ba2);
      border: none;
      border-radius: 12px;
      padding: 0.6rem 1.5rem;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
    }
    .offer-item .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }

    /* Featured card styles */
    .featured-card {
      border: 3px solid #ffd700 !important;
      box-shadow: 0 8px 30px rgba(255, 215, 0, 0.3);
    }
    .featured-badge {
      position: absolute;
      top: 10px;
      left: 10px;
      background: linear-gradient(135deg, #ffd700, #ffed4e);
      color: #000;
      padding: 0.5rem 1rem;
      border-radius: 20px;
      font-weight: 800;
      font-size: 0.9rem;
      box-shadow: 0 4px 15px rgba(255, 215, 0, 0.5);
      z-index: 3;
    }

    /* Compact card styles */
    .compact-card .p-3 {
      padding: 0.75rem !important;
    }
    .compact-card h5 {
      font-size: 1rem;
    }
    .compact-card .price-badge {
      font-size: 1rem;
      padding: 0.4rem 0.8rem;
    }
    .discount-badge {
      position: absolute;
      bottom: 10px;
      left: 10px;
      background: linear-gradient(135deg, #ff6b6b, #ee5a6f);
      color: white;
      padding: 0.3rem 0.8rem;
      border-radius: 15px;
      font-weight: 700;
      font-size: 0.8rem;
      box-shadow: 0 4px 15px rgba(238, 90, 111, 0.4);
      z-index: 3;
    }

    /* Rating stars */
    .rating-stars {
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }
    .rating-stars i {
      font-size: 0.9rem;
    }

    /* Make detail button more prominent */
    .offer-item .btn-details {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      padding: 0.65rem 1rem;
      border-radius: 10px;
      background: white;
      color: #3b3b98;
      border: 2px solid rgba(102,126,234,0.12);
      font-weight: 700;
      box-shadow: 0 6px 18px rgba(59,59,152,0.06);
      transition: all 0.28s ease;
    }
    .offer-item .btn-details i { font-size: 1.05rem; }
    .offer-item .btn-details:hover {
      transform: translateY(-4px);
      background: linear-gradient(135deg, #f7f9ff, #eef2ff);
      box-shadow: 0 12px 30px rgba(59,59,152,0.12);
    }
    .country-badge {
      display: block;
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
      padding: 0.3rem 0.8rem;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
      margin-top: 0.5rem;
      text-align: center;
    }
    html {
      scroll-behavior: smooth;
    }
    * {
      scroll-behavior: smooth;
    }
    .modal-body {
      scroll-behavior: smooth;
    }
    .modal-body::-webkit-scrollbar {
      width: 8px;
    }
    .modal-body::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 10px;
    }
    .modal-body::-webkit-scrollbar-thumb {
      background: linear-gradient(135deg, #667eea, #764ba2);
      border-radius: 10px;
    }
    .modal-body::-webkit-scrollbar-thumb:hover {
      background: linear-gradient(135deg, #764ba2, #667eea);
    }

    /* Beautiful button click effects */
    button:active, .btn:active {
      transform: scale(0.98) !important;
      box-shadow: inset 0 4px 8px rgba(0,0,0,0.2) !important;
      transition: all 0.1s ease !important;
    }

    /* Enhanced button styles for beauty */
    .btn, button {
      position: relative;
      overflow: hidden;
    }

    .btn::before, button::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      transition: width 0.3s ease, height 0.3s ease;
      transform: translate(-50%, -50%);
    }

    .btn:active::before, button:active::before {
      width: 300px;
      height: 300px;
    }

    /* Option hover and click effects for selects */
    option:active, option:focus {
      background: linear-gradient(135deg, #f0f4ff, #e6f0ff) !important;
      color: #667eea !important;
      font-weight: 600 !important;
      transform: scale(1.02);
    }

    /* Mobile responsiveness improvements */
    @media (max-width: 768px) {
      body {
        padding-top: 60px;
      }

      .hero-header h1 {
        font-size: 2rem;
      }

      .hero-header .lead {
        font-size: 1rem;
      }

      .search-field {
        padding: 0.5rem 0.75rem;
        margin-bottom: 0.5rem;
      }

      .search-field label {
        font-size: 0.7rem;
      }

      .search-field .form-control,
      .search-field .form-select {
        font-size: 0.9rem;
        padding: 0.5rem 0.75rem;
      }

      .btn-search {
        font-size: 0.9rem;
        padding: 0.5rem 1.5rem;
        height: 40px;
      }

      .offer-item {
        margin-bottom: 1rem;
      }

      .offer-item h5 {
        font-size: 1.1rem;
      }

      .price-badge {
        top: 10px;
        right: 10px;
        font-size: 1rem;
        padding: 0.4rem 1rem;
      }

      .country-badge {
        font-size: 0.7rem;
        padding: 0.2rem 0.6rem;
      }

      .offer-item .btn-details,
      .offer-item .btn-primary {
        font-size: 0.9rem;
        padding: 0.5rem 0.8rem;
      }

      .results-count h5 {
        font-size: 1rem;
      }

      .modal-dialog {
        margin: 0.5rem;
      }

      .modal-body {
        padding: 1rem;
      }

      .form-control,
      .form-select {
        font-size: 0.9rem;
        padding: 0.5rem 0.75rem;
      }

      .btn {
        font-size: 0.9rem;
        padding: 0.5rem 1rem;
      }

      .card-header {
        padding: 0.75rem 1rem;
        font-size: 0.9rem;
      }

      .card-body {
        padding: 1rem;
      }

      .navbar-brand {
        font-size: 1.1rem;
      }

      .navbar-toggler {
        padding: 0.25rem 0.5rem;
      }

      .nav-link {
        font-size: 0.9rem;
      }
    }

    @media (max-width: 576px) {
      .hero-header h1 {
        font-size: 1.75rem;
      }

      .hero-header .lead {
        font-size: 0.9rem;
      }

      .search-box-wrapper {
        padding: 0.75rem;
      }

      .offer-item {
        border-radius: 16px;
      }

      .offer-img {
        height: 180px;
      }

      .offer-item .p-3 {
        padding: 1rem !important;
      }

      .modal-xl {
        max-width: 95vw;
      }

      .modal-body {
        padding: 0.75rem;
      }

      .row.g-3 {
        --bs-gutter-x: 0.5rem;
        --bs-gutter-y: 0.5rem;
      }

      .d-grid.gap-2 {
        gap: 0.5rem !important;
      }

      .badge {
        font-size: 0.8rem;
        padding: 0.3rem 0.6rem;
      }

      .toast-container {
        top: 10px;
        right: 10px;
        left: 10px;
      }

      .toast-notification {
        min-width: auto;
        font-size: 0.9rem;
        padding: 0.75rem 1rem;
      }
    }
  </style>
</head>
<body>
  <!-- Toast Container -->
  <div class="toast-container" id="toastContainer"></div>

  <nav id="mainNavbar" class="navbar navbar-expand-lg navbar-light bg-white border-bottom fixed-top">
    <div class="container">
      <a class="navbar-brand fw-bold text-primary" href="index.html">LND-Reisen</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item">
            <a class="nav-link" href="index.html">Startseite</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="index.html#angebote">Top-Angebote</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="index.html#reiseziele">Reiseziele</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="angebote.html">Alle Angebote</a>
          </li>
          <li class="nav-item" id="navRegister">
            <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#registerModal">Registrieren</a>
          </li>
          <li class="nav-item" id="navLogin">
            <a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#loginModal">Anmelden</a>
          </li>
          <li class="nav-item dropdown" id="navUser" style="display: none;">
            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
              <i class="bi bi-person-circle"></i> <span id="navUserName"></span>
            </a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#profileModal" onclick="loadProfile()"><i class="bi bi-person me-2"></i>Mein Profil</a></li>
              <li><a class="dropdown-item" href="#" onclick="logout()"><i class="bi bi-box-arrow-right me-2"></i>Abmelden</a></li>
            </ul>
          </li>

        </ul>
      </div>
    </div>
  </nav>

  <!-- LOGIN MODAL -->
  <div class="modal fade" id="loginModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content border-0 shadow-lg">
        <div class="modal-header border-0 pb-0">
          <h5 class="modal-title fw-bold"><i class="bi bi-box-arrow-in-right me-2 text-primary"></i>Anmelden</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body px-4 pb-4">
          <form id="loginForm">
            <div class="mb-3">
              <label class="form-label fw-semibold"><i class="bi bi-envelope me-2"></i>E-Mail</label>
              <input type="email" id="loginEmail" class="form-control form-control-lg" placeholder="ihre@email.com" required>
            </div>
            <div class="mb-3">
              <label class="form-label fw-semibold"><i class="bi bi-lock me-2"></i>Passwort</label>
              <input type="password" id="loginPassword" class="form-control form-control-lg" placeholder="••••••••" required>
            </div>
            <button type="submit" class="btn btn-primary btn-lg w-100 mt-3">
              <i class="bi bi-check-circle me-2"></i>Anmelden
            </button>
            <p class="text-center mt-3 mb-0 text-muted">Noch kein Konto? <a href="#" data-bs-toggle="modal" data-bs-target="#registerModal" data-bs-dismiss="modal" class="text-primary fw-semibold">Jetzt registrieren</a></p>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- REGISTER MODAL -->
  <div class="modal fade" id="registerModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content border-0 shadow-lg">
        <div class="modal-header border-0 pb-0">
          <h5 class="modal-title fw-bold"><i class="bi bi-person-plus me-2 text-primary"></i>Konto erstellen</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body px-4 pb-4">
          <form id="registerForm">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label class="form-label fw-semibold"><i class="bi bi-person me-2"></i>Vorname</label>
                <input type="text" id="regFirstName" class="form-control form-control-lg" placeholder="Max" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label fw-semibold"><i class="bi bi-person me-2"></i>Nachname</label>
                <input type="text" id="regLastName" class="form-control form-control-lg" placeholder="Mustermann" required>
              </div>
            </div>
            <div class="mb-3">
              <label class="form-label fw-semibold"><i class="bi bi-envelope me-2"></i>E-Mail</label>
              <input type="email" id="regEmail" class="form-control form-control-lg" placeholder="max@beispiel.com" required>
            </div>
            <div class="mb-3">
              <label class="form-label fw-semibold"><i class="bi bi-lock me-2"></i>Passwort</label>
              <input type="password" id="regPassword" class="form-control form-control-lg" placeholder="Mindestens 6 Zeichen" required>
            </div>
            <div class="mb-3">
              <label class="form-label fw-semibold"><i class="bi bi-lock-fill me-2"></i>Passwort bestätigen</label>
              <input type="password" id="regPasswordConfirm" class="form-control form-control-lg" placeholder="Passwort wiederholen" required>
            </div>
            <button type="submit" class="btn btn-primary btn-lg w-100 mt-3">
              <i class="bi bi-check-circle me-2"></i>Jetzt registrieren
            </button>
            <p class="text-center mt-3 mb-0 text-muted">Bereits registriert? <a href="#" data-bs-toggle="modal" data-bs-target="#loginModal" data-bs-dismiss="modal" class="text-primary fw-semibold">Jetzt anmelden</a></p>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- OFFER DETAIL MODAL -->
  <div class="modal fade" id="offerDetailModal" tabindex="-1">
    <div class="modal-dialog modal-xl modal-dialog-centered">
      <div class="modal-content border-0 shadow-lg" style="border-radius: 24px; overflow: hidden;">
        <button type="button" class="btn-close position-absolute top-0 end-0 m-3 bg-white rounded-circle p-3 shadow" style="z-index: 1050; opacity: 1;" data-bs-dismiss="modal"></button>
        <div class="modal-body p-0">
          <div class="row g-0">
            <div class="col-lg-6">
              <div class="position-relative" style="height: 100%; min-height: 500px;">
                <img id="detailImage" src="" class="w-100 h-100" style="object-fit: cover;" alt="Reiseziel">
                <div class="position-absolute bottom-0 start-0 w-100 p-4" style="background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);">
                  <h2 class="text-white fw-bold mb-1" id="detailCity"></h2>
                  <p class="text-white mb-0 fs-5"><i class="bi bi-geo-alt-fill me-2"></i><span id="detailCountry"></span></p>
                </div>
                <div class="position-absolute top-0 end-0 m-3">
                  <span class="badge" style="background: linear-gradient(135deg, #ff6b6b, #ee5a6f); font-size: 1.5rem; padding: 0.8rem 1.5rem; border-radius: 20px; box-shadow: 0 8px 25px rgba(238, 90, 111, 0.4);">
                    <span id="detailPrice"></span>€
                  </span>
                </div>
              </div>
            </div>
            <div class="col-lg-6">
              <div class="p-5" style="height: 100%; overflow-y: auto; max-height: 600px; scroll-behavior: smooth;">
                <div class="mb-4">
                  <span class="badge bg-success mb-3" style="font-size: 0.9rem; padding: 0.5rem 1rem;">✓ Verfügbar</span>
                  <h5 class="text-muted mb-3">ab <span id="detailPrice2" class="text-dark fw-bold"></span>€ pro Person</h5>
                </div>

                <div class="row g-3 mb-4">
                  <div class="col-6">
                    <div class="p-3 rounded" style="background: linear-gradient(135deg, #667eea15, #764ba215); border-left: 4px solid #667eea;">
                      <div class="d-flex align-items-center">
                        <i class="bi bi-airplane-fill fs-3 me-3" style="color: #667eea;"></i>
                        <div>
                          <small class="text-muted d-block">Abflug von</small>
                          <strong id="detailAirport"></strong>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-6">
                    <div class="p-3 rounded" style="background: linear-gradient(135deg, #43e97b15, #38f9d715); border-left: 4px solid #43e97b;">
                      <div class="d-flex align-items-center">
                        <i class="bi bi-star-fill fs-3 me-3" style="color: #43e97b;"></i>
                        <div>
                          <small class="text-muted d-block">Bewertung</small>
                          <strong><span id="detailRating"></span> / 5.0</strong>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="mb-4">
                  <h6 class="fw-bold mb-3 d-flex align-items-center">
                    <span class="bg-primary text-white rounded-circle d-inline-flex align-items-center justify-content-center me-2" style="width: 32px; height: 32px;">
                      <i class="bi bi-info-circle"></i>
                    </span>
                    Reisebeschreibung
                  </h6>
                  <p class="text-muted" style="line-height: 1.8;" id="detailDescription"></p>
                  <p class="text-muted" style="line-height: 1.8;"><strong>Hotel:</strong> <span id="detailHotel"></span></p>
                </div>

                <div class="mb-4 p-4 rounded" style="background: linear-gradient(135deg, #667eea10, #764ba210);">
                  <h6 class="fw-bold mb-3 d-flex align-items-center">
                    <span class="bg-success text-white rounded-circle d-inline-flex align-items-center justify-content-center me-2" style="width: 32px; height: 32px;">
                      <i class="bi bi-check-lg"></i>
                    </span>
                    Inklusivleistungen
                  </h6>
                  <div class="row g-2">
                    <div class="col-6">
                      <div class="d-flex align-items-center">
                        <i class="bi bi-check-circle-fill text-success me-2"></i>
                        <span>Hin- & Rückflug</span>
                      </div>
                    </div>
                    <div class="col-6">
                      <div class="d-flex align-items-center">
                        <i class="bi bi-check-circle-fill text-success me-2"></i>
                        <span>Hotel mit Frühstück</span>
                      </div>
                    </div>
                    <div class="col-6">
                      <div class="d-flex align-items-center">
                        <i class="bi bi-check-circle-fill text-success me-2"></i>
                        <span>Flughafentransfer</span>
                      </div>
                    </div>
                    <div class="col-6">
                      <div class="d-flex align-items-center">
                        <i class="bi bi-check-circle-fill text-success me-2"></i>
                        <span>Reiseversicherung</span>
                      </div>
                    </div>
                    <div class="col-6">
                      <div class="d-flex align-items-center">
                        <i class="bi bi-check-circle-fill text-success me-2"></i>
                        <span>24/7 Support</span>
                      </div>
                    </div>
                    <div class="col-6">
                      <div class="d-flex align-items-center">
                        <i class="bi bi-check-circle-fill text-success me-2"></i>
                        <span>Reiseführer</span>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="d-grid gap-2">
                  <button class="btn btn-lg" id="bookOfferBtn" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; padding: 1rem; font-weight: 600; border-radius: 12px; box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);">
                    <i class="bi bi-cart-plus me-2"></i>Jetzt buchen - <span id="detailPrice3"></span>€
                  </button>
                  <button class="btn btn-outline-secondary btn-lg" style="border-radius: 12px; padding: 1rem; font-weight: 600;">
                    <i class="bi bi-heart me-2"></i>Auf Merkliste
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- BOOKING MODAL -->
  <div class="modal fade" id="bookingModal" tabindex="-1">
    <div class="modal-dialog modal-xl modal-dialog-scrollable">
      <div class="modal-content" style="border-radius: 20px; border: none; box-shadow: 0 10px 50px rgba(0,0,0,0.2);">
        <div class="modal-header text-white" style="background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 20px 20px 0 0; padding: 1.5rem;">
          <h5 class="modal-title fw-bold"><i class="bi bi-cart-check me-2"></i>Buchung: <span id="bookingOfferTitle"></span></h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body" style="padding: 2rem;">
          <!-- Section: Traveler Details -->
          <div class="mb-5">
            <h6 class="fw-bold mb-4 text-primary" style="border-bottom: 2px solid #667eea; padding-bottom: 0.5rem;"><i class="bi bi-people-fill me-2"></i>Daten der Reisenden</h6>
            <p class="text-muted mb-3">Bitte geben Sie die persönlichen Daten für alle Reisenden ein.</p>
            <div id="travelersContainer"></div>
          </div>

          <!-- Divider -->
          <hr class="my-5" style="border: 1px solid #e9ecef;">

          <!-- Section: Billing Details -->
          <div class="mb-5">
            <h6 class="fw-bold mb-4 text-primary" style="border-bottom: 2px solid #667eea; padding-bottom: 0.5rem;"><i class="bi bi-receipt me-2"></i>Ihre Daten für die Rechnung (Reiseanmelder)</h6>
            <p class="text-muted mb-3">Diese Daten werden für die Rechnung und Kommunikation verwendet.</p>
            <div class="form-check mb-4 p-3 bg-light rounded" style="border: 1px solid #dee2e6;">
              <input class="form-check-input" type="checkbox" id="copyFromTraveler1" onchange="toggleBillingData()">
              <label class="form-check-label fw-semibold" for="copyFromTraveler1">
                <i class="bi bi-check-circle me-2"></i>Daten von Person 1 übernehmen
              </label>
            </div>
            <div id="billingDataContainer">
              <div class="row g-3">
                <div class="col-md-2">
                  <label class="form-label fw-semibold"><i class="bi bi-person-badge me-1"></i>Anrede</label>
                  <select class="form-control form-control-lg" id="billingAnrede" required>
                    <option value="">Bitte wählen</option>
                    <option value="Herr">Herr</option>
                    <option value="Frau">Frau</option>
                  </select>
                </div>
                <div class="col-md-5">
                  <label class="form-label fw-semibold"><i class="bi bi-person me-1"></i>Vorname</label>
                  <input type="text" class="form-control form-control-lg" id="billingVorname" placeholder="Max" required>
                </div>
                <div class="col-md-5">
                  <label class="form-label fw-semibold"><i class="bi bi-person me-1"></i>Nachname</label>
                  <input type="text" class="form-control form-control-lg" id="billingNachname" placeholder="Mustermann" required>
                </div>
                <div class="col-md-4">
                  <label class="form-label fw-semibold"><i class="bi bi-calendar-event me-1"></i>Geburtsdatum</label>
                  <input type="date" class="form-control form-control-lg" id="billingGeburtsdatum" required>
                </div>
                <div class="col-md-2">
                  <label class="form-label fw-semibold"><i class="bi bi-geo-alt me-1"></i>PLZ</label>
                  <input type="text" class="form-control form-control-lg" id="billingPLZ" placeholder="12345" required>
                </div>
                <div class="col-md-6">
                  <label class="form-label fw-semibold"><i class="bi bi-geo-alt me-1"></i>Ort</label>
                  <input type="text" class="form-control form-control-lg" id="billingOrt" placeholder="Berlin" required>
                </div>
                <div class="col-md-8">
                  <label class="form-label fw-semibold"><i class="bi bi-house me-1"></i>Straße Nr.</label>
                  <input type="text" class="form-control form-control-lg" id="billingStrasse" placeholder="Musterstraße 123" required>
                </div>
                <div class="col-md-4">
                  <label class="form-label fw-semibold"><i class="bi bi-flag me-1"></i>Land</label>
                  <select class="form-control form-control-lg" id="billingLand" required>
                    <option value="">Bitte wählen</option>
                    <option value="Deutschland">Deutschland</option>
                    <option value="Österreich">Österreich</option>
                    <option value="Schweiz">Schweiz</option>
                  </select>
                </div>
                <div class="col-md-6">
                  <label class="form-label fw-semibold"><i class="bi bi-telephone me-1"></i>Mobilnummer</label>
                  <input type="tel" class="form-control form-control-lg" id="billingMobil" placeholder="+49 123 456789" required>
                </div>
                <div class="col-md-6">
                  <label class="form-label fw-semibold"><i class="bi bi-envelope me-1"></i>Email-Adresse</label>
                  <input type="email" class="form-control form-control-lg" id="billingEmail" placeholder="max@beispiel.com" required>
                </div>
              </div>
            </div>
          </div>

          <!-- Divider -->
          <hr class="my-5" style="border: 1px solid #e9ecef;">

          <!-- Section: Total Price -->
          <div class="alert alert-success" style="background: linear-gradient(135deg, #43e97b15, #38f9d715); border: 2px solid #43e97b; border-radius: 15px; padding: 1.5rem;">
            <h5 class="mb-0 fw-bold" style="color: #2d3748;"><i class="bi bi-cash-stack me-2" style="color: #43e97b;"></i>Gesamtpreis: <span id="bookingTotalPrice" style="color: #43e97b; font-size: 1.5rem;"></span>€</h5>
            <small class="text-muted">Inklusive aller Gebühren und Steuern</small>
          </div>
        </div>
        <div class="modal-footer" style="padding: 1.5rem; border-top: 2px solid #f0f0f0;">
          <button class="btn btn-secondary btn-lg" data-bs-dismiss="modal" style="border-radius: 10px; padding: 0.75rem 2rem;"><i class="bi bi-x-circle me-2"></i>Abbrechen</button>
          <button class="btn btn-lg" onclick="proceedToPayment()" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; border-radius: 10px; padding: 0.75rem 2rem; font-weight: 600;"><i class="bi bi-arrow-right-circle me-2"></i>Weiter zur Zahlung</button>
        </div>
      </div>
    </div>
  </div>

  <!-- PAYMENT MODAL -->
  <div class="modal fade" id="paymentModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content" style="border-radius: 20px; border: none; box-shadow: 0 10px 50px rgba(0,0,0,0.2);">
        <div class="modal-header text-white" style="background: linear-gradient(135deg, #43e97b, #38f9d7); border-radius: 20px 20px 0 0; padding: 1.5rem;">
          <h5 class="modal-title fw-bold"><i class="bi bi-credit-card me-2"></i>Zahlung</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body" style="padding: 2rem;">
          <h6 class="mb-4" style="color: #2d3748; font-size: 1.1rem;"><i class="bi bi-wallet2 me-2"></i>Zahlungsmethode wählen:</h6>
          <div class="form-check mb-3 p-4 border-0" style="background: linear-gradient(135deg, #667eea15, #764ba215); border-radius: 15px; cursor: pointer; transition: all 0.3s;" onmouseover="this.style.transform='scale(1.02)'" onmouseout="this.style.transform='scale(1)'">
            <input class="form-check-input" type="radio" name="paymentMethod" value="card" id="payCard" style="width: 20px; height: 20px; cursor: pointer;" onchange="showPaymentForm('card')">
            <label class="form-check-label" for="payCard" style="cursor: pointer; font-size: 1.1rem; font-weight: 600; margin-left: 10px;">
              <i class="bi bi-credit-card-2-front me-2" style="font-size: 1.3rem; color: #667eea;"></i>Kreditkarte
            </label>
          </div>
          <div class="form-check mb-3 p-4 border-0" style="background: linear-gradient(135deg, #f093fb15, #f5576c15); border-radius: 15px; cursor: pointer; transition: all 0.3s;" onmouseover="this.style.transform='scale(1.02)'" onmouseout="this.style.transform='scale(1)'">
            <input class="form-check-input" type="radio" name="paymentMethod" value="paypal" id="payPaypal" style="width: 20px; height: 20px; cursor: pointer;" onchange="showPaymentForm('paypal')">
            <label class="form-check-label" for="payPaypal" style="cursor: pointer; font-size: 1.1rem; font-weight: 600; margin-left: 10px;">
              <i class="bi bi-paypal me-2" style="font-size: 1.3rem; color: #f093fb;"></i>PayPal
            </label>
          </div>
          <div class="form-check mb-3 p-4 border-0" style="background: linear-gradient(135deg, #4facfe15, #00f2fe15); border-radius: 15px; cursor: pointer; transition: all 0.3s;" onmouseover="this.style.transform='scale(1.02)'" onmouseout="this.style.transform='scale(1)'">
            <input class="form-check-input" type="radio" name="paymentMethod" value="bank" id="payBank" style="width: 20px; height: 20px; cursor: pointer;" onchange="showPaymentForm('bank')">
            <label class="form-check-label" for="payBank" style="cursor: pointer; font-size: 1.1rem; font-weight: 600; margin-left: 10px;">
              <i class="bi bi-bank me-2" style="font-size: 1.3rem; color: #4facfe;"></i>Überweisung
            </label>
          </div>

          <!-- Payment Forms -->
          <div id="cardForm" style="display: none; margin-top: 2rem;">
            <h6 class="mb-4" style="color: #2d3748; font-weight: 600;"><i class="bi bi-credit-card-2-front me-2"></i>Kreditkartendaten</h6>
            <div class="row g-3">
              <div class="col-12">
                <label class="form-label fw-semibold">Name auf der Karte</label>
                <input type="text" class="form-control form-control-lg" id="cardName" placeholder="Max Mustermann" required>
              </div>
              <div class="col-12">
                <label class="form-label fw-semibold">Kartennummer</label>
                <input type="text" class="form-control form-control-lg" id="cardNumber" placeholder="1234 5678 9012 3456" required>
              </div>
              <div class="col-6">
                <label class="form-label fw-semibold">Ablaufdatum</label>
                <input type="text" class="form-control form-control-lg" id="cardExpiry" placeholder="MM/YY" required>
              </div>
              <div class="col-6">
                <label class="form-label fw-semibold">CVV</label>
                <input type="text" class="form-control form-control-lg" id="cardCvv" placeholder="123" required>
              </div>
            </div>
          </div>

          <div id="paypalForm" style="display: none; margin-top: 2rem;">
            <h6 class="mb-4" style="color: #2d3748; font-weight: 600;"><i class="bi bi-paypal me-2"></i>PayPal-Konto</h6>
            <div class="row g-3">
              <div class="col-12">
                <label class="form-label fw-semibold">PayPal E-Mail-Adresse</label>
                <input type="email" class="form-control form-control-lg" id="paypalEmail" placeholder="max@beispiel.com" required>
              </div>
            </div>
          </div>

          <div id="bankForm" style="display: none; margin-top: 2rem;">
            <h6 class="mb-4" style="color: #2d3748; font-weight: 600;"><i class="bi bi-bank me-2"></i>Banküberweisung</h6>
            <div class="alert alert-info" style="background: linear-gradient(135deg, #4facfe15, #00f2fe15); border: 2px solid #4facfe;">
              <strong>Überweisungsdaten:</strong> Bitte überweisen Sie den Betrag innerhalb von 7 Tagen auf das folgende Konto.
            </div>
            <div class="row g-3">
              <div class="col-12">
                <label class="form-label fw-semibold">Empfänger</label>
                <input type="text" class="form-control form-control-lg" id="bankName" value="LND-Reisen GmbH" readonly>
              </div>
              <div class="col-12">
                <label class="form-label fw-semibold">IBAN</label>
                <input type="text" class="form-control form-control-lg" id="bankIban" readonly>
              </div>
              <div class="col-12">
                <label class="form-label fw-semibold">BIC</label>
                <input type="text" class="form-control form-control-lg" id="bankBic" value="DEUTDEFFXXX" readonly>
              </div>
              <div class="col-12">
                <label class="form-label fw-semibold">Verwendungszweck</label>
                <input type="text" class="form-control form-control-lg" id="bankDescription" readonly>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer" style="padding: 1.5rem; border-top: 2px solid #f0f0f0;">
          <button class="btn btn-secondary btn-lg" data-bs-dismiss="modal" style="border-radius: 10px; padding: 0.75rem 2rem;"><i class="bi bi-arrow-left-circle me-2"></i>Zurück</button>
          <button class="btn btn-lg" onclick="completePayment()" style="background: linear-gradient(135deg, #43e97b, #38f9d7); color: white; border: none; border-radius: 10px; padding: 0.75rem 2rem; font-weight: 600; box-shadow: 0 4px 15px rgba(67, 233, 123, 0.3);"><i class="bi bi-check-circle me-2"></i>Jetzt bezahlen</button>
        </div>
      </div>
    </div>
  </div>

  <!-- PROFILE MODAL -->
  <div class="modal fade" id="profileModal" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content border-0 shadow-lg">
        <div class="modal-header border-0 bg-primary text-white">
          <h5 class="modal-title fw-bold"><i class="bi bi-person-circle me-2"></i>Mein Profil</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body p-4">
          <div class="row">
            <div class="col-md-4 text-center mb-4">
              <div class="avatar-large bg-primary text-white rounded-circle d-flex align-items-center justify-content-center mx-auto mb-3" id="profileAvatar" style="width: 100px; height: 100px; font-size: 2.5rem;"></div>
              <h5 class="fw-bold" id="profileFullName"></h5>
              <p class="text-muted" id="profileEmail"></p>
            </div>
            <div class="col-md-8">
              <div class="d-flex justify-content-between align-items-center mb-3">
                <h6 class="fw-bold mb-0">Persönliche Informationen</h6>
                <button class="btn btn-sm btn-outline-primary" id="editProfileBtn">
                  <i class="bi bi-pencil me-1"></i>Bearbeiten
                </button>
              </div>
              
              <div id="profileView">
                <div class="row g-3 mb-4">
                  <div class="col-6">
                    <div class="p-3 bg-light rounded">
                      <small class="text-muted">Vorname</small>
                      <div class="fw-semibold" id="profileFirstName"></div>
                    </div>
                  </div>
                  <div class="col-6">
                    <div class="p-3 bg-light rounded">
                      <small class="text-muted">Nachname</small>
                      <div class="fw-semibold" id="profileLastName"></div>
                    </div>
                  </div>
                  <div class="col-6">
                    <div class="p-3 bg-light rounded">
                      <small class="text-muted">Telefon</small>
                      <div class="fw-semibold" id="profilePhone">Nicht angegeben</div>
                    </div>
                  </div>
                  <div class="col-6">
                    <div class="p-3 bg-light rounded">
                      <small class="text-muted">Registriert seit</small>
                      <div class="fw-semibold" id="profileDatum"></div>
                    </div>
                  </div>
                  <div class="col-12">
                    <div class="p-3 bg-light rounded">
                      <small class="text-muted">Adresse</small>
                      <div class="fw-semibold" id="profileAddress">Nicht angegeben</div>
                    </div>
                  </div>
                </div>
              </div>
              
              <div id="profileEdit" style="display: none;">
                <form id="profileEditForm">
                  <div class="row g-3 mb-3">
                    <div class="col-6">
                      <label class="form-label">Vorname</label>
                      <input type="text" class="form-control" id="editFirstName" required>
                    </div>
                    <div class="col-6">
                      <label class="form-label">Nachname</label>
                      <input type="text" class="form-control" id="editLastName" required>
                    </div>
                    <div class="col-6">
                      <label class="form-label">Telefon</label>
                      <input type="tel" class="form-control" id="editPhone">
                    </div>
                    <div class="col-6">
                      <label class="form-label">Geburtsdatum</label>
                      <input type="date" class="form-control" id="editBirthDate">
                    </div>
                    <div class="col-12">
                      <label class="form-label">Adresse</label>
                      <textarea class="form-control" id="editAddress" rows="2"></textarea>
                    </div>
                  </div>
                  <div class="d-flex gap-2 mb-3">
                    <button type="submit" class="btn btn-primary">Speichern</button>
                    <button type="button" class="btn btn-secondary" id="cancelEditBtn">Abbrechen</button>
                  </div>
                </form>
              </div>
              
              <h6 class="fw-bold mb-3">Meine Buchungen</h6>
              <div id="profileBuchungen"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="container my-5">
    <div class="hero-header text-center mb-5">
      <h1 class="display-3 fw-bold mb-3">
        <i class="bi bi-globe-americas me-3"></i>Traumreisen weltweit
      </h1>
      <p class="lead text-muted mb-2">Entdecke über 200 exklusive Reiseziele auf allen Kontinenten</p>
      <div class="d-flex justify-content-center gap-3 flex-wrap">
        <span class="badge bg-primary">Direktflüge</span>
        <span class="badge bg-success">Top Hotels</span>
        <span class="badge bg-info">Beste Preise</span>
        <span class="badge bg-warning text-dark">Geprüfte Qualität</span>
      </div>
    </div>
    
    <div class="filter-section">
      <div class="search-box-wrapper">
        <!-- Erster Stock: Grundlegende Suchkriterien -->
        <div class="row g-0 mb-1">
          <div class="col-lg-4 col-md-6">
            <div class="search-field">
              <label><i class="bi bi-geo-alt-fill"></i> Wohin?</label>
              <input type="text" class="form-control" id="destinationFilter" placeholder="Reiseziel eingeben">
            </div>
          </div>
          <div class="col-lg-4 col-md-6">
            <div class="search-field">
              <label><i class="bi bi-people-fill"></i> Reiseart</label>
              <select class="form-select" id="tourTypeFilter">
                <option value="">Alle Reisearten</option>
                <option value="couples">Für Paare</option>
                <option value="family-kids">Familie mit Kindern</option>
                <option value="family-no-kids">Familie ohne Kinder</option>
                <option value="friends">Freunde</option>
                <option value="solo">Alleinreisende</option>
              </select>
            </div>
          </div>
          <div class="col-lg-4 col-md-6">
            <div class="search-field">
              <label><i class="bi bi-airplane-fill"></i> Von</label>
              <select class="form-select" id="airportFilter">
                <option value="">Alle</option>
                <option value="Wien">Wien</option>
                <option value="Salzburg">Salzburg</option>
                <option value="Innsbruck">Innsbruck</option>
                <option value="Graz">Graz</option>
                <option value="Linz">Linz</option>
                <option value="Klagenfurt">Klagenfurt</option>
              </select>
            </div>
          </div>
        </div>
        <!-- Zweiter Stock: Preis und Sortierung -->
        <div class="row g-0">
          <div class="col-lg-3 col-md-6">
            <div class="search-field">
              <label><i class="bi bi-cash"></i> Min. €</label>
              <input type="number" class="form-control" id="minPrice" placeholder="0" min="0" value="0">
            </div>
          </div>
          <div class="col-lg-3 col-md-6">
            <div class="search-field">
              <label><i class="bi bi-cash-stack"></i> Max. €</label>
              <input type="number" class="form-control" id="maxPrice" placeholder="5000" max="10000" value="5000">
            </div>
          </div>
          <div class="col-lg-3 col-md-6">
            <div class="search-field">
              <label><i class="bi bi-sort-down"></i> Sortieren</label>
              <select class="form-select" id="sortFilter">
                <option value="price-asc">Preis aufsteigend</option>
                <option value="price-desc">Preis absteigend</option>
                <option value="date-asc">Datum aufsteigend</option>
              </select>
            </div>
          </div>
          <div class="col-lg-3 col-md-6">
            <div class="search-field-btn">
              <button class="btn btn-search" onclick="applyFilters()"><i class="bi bi-search"></i> Suchen</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="results-count">
      <h5 class="mb-0"><i class="bi bi-list-check me-2 text-primary"></i><span id="resultsCount">0</span> Angebote gefunden</h5>
    </div>
    <div class="row" id="offersContainer"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Toast notification system
    function showToast(message, type = 'info', duration = 4000) {
      const container = document.getElementById('toastContainer');
      if (!container) return;
      
      const icons = {
        success: 'bi-check-circle-fill',
        error: 'bi-x-circle-fill',
        warning: 'bi-exclamation-triangle-fill',
        info: 'bi-info-circle-fill'
      };
      
      const toast = document.createElement('div');
      toast.className = `toast-notification ${type}`;
      toast.innerHTML = `<i class="bi ${icons[type]}"></i>${message}`;
      
      container.appendChild(toast);
      
      setTimeout(() => toast.classList.add('show'), 100);
      
      setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => toast.remove(), 400);
      }, duration);
    }

    const destinations = [
      {city: 'Bali', country: 'Indonesien'},
      {city: 'Barcelona', country: 'Spanien'},
      {city: 'Kapstadt', country: 'Südafrika'},
      {city: 'Dubai', country: 'VAE'},
      {city: 'Edinburgh', country: 'Großbritannien'},
      {city: 'Reykjavik', country: 'Island'},
      {city: 'Kyoto', country: 'Japan'},
      {city: 'Lissabon', country: 'Portugal'},
      {city: 'Malediven', country: 'Malediven'},
      {city: 'Marrakesch', country: 'Marokko'},
      {city: 'New York', country: 'USA'},
      {city: 'Paris', country: 'Frankreich'},
      {city: 'Santorini', country: 'Griechenland'},
      {city: 'Sydney', country: 'Australien'},
      {city: 'Bangkok', country: 'Thailand'},
      {city: 'Vancouver', country: 'Kanada'},
      {city: 'Bologna', country: 'Italien'},
      {city: 'Bordeaux', country: 'Frankreich'},
      {city: 'Florenz', country: 'Italien'},
      {city: 'Glasgow', country: 'Großbritannien'},
      {city: 'Granada', country: 'Spanien'},
      {city: 'Ibiza', country: 'Spanien'},
      {city: 'Liverpool', country: 'Großbritannien'},
      {city: 'London', country: 'Großbritannien'},
      {city: 'Madrid', country: 'Spanien'},
      {city: 'Mailand', country: 'Italien'},
      {city: 'Malaga', country: 'Spanien'},
      {city: 'Manchester', country: 'Großbritannien'},
      {city: 'Marseille', country: 'Frankreich'},
      {city: 'Neapel', country: 'Italien'},
      {city: 'Nizza', country: 'Frankreich'},
      {city: 'Palma', country: 'Spanien'},
      {city: 'Sevilla', country: 'Spanien'},
      {city: 'Toulouse', country: 'Frankreich'},
      {city: 'Turin', country: 'Italien'},
      {city: 'Valencia', country: 'Spanien'},
      {city: 'Venedig', country: 'Italien'},
      {city: 'Verona', country: 'Italien'}
    ];

    const airports = ['Wien', 'Salzburg', 'Innsbruck', 'Graz', 'Linz', 'Klagenfurt'];
    
    function getImageForDestination(destination) {
      const localImages = {
        Bali: "img/bali.jpg",
        Barcelona: "img/barcelona.jpg",
        Kapstadt: "img/capetown.jpg",
        Dubai: "img/dubai.jpg",
        Edinburgh: "img/edinburgh.jpg",
        Reykjavik: "img/Island.jpg",
        Kyoto: "img/kyoto.jpg",
        Lissabon: "img/Lissabon.jpg",
        Malediven: "img/Malediven.jpg",
        Marrakesch: "img/marrakech.jpg",
        "New York": "img/New York.jpg",
        Paris: "img/Paris.jpg",
        Santorini: "img/santorini.webp",
        Sydney: "img/sydney.jpg",
        Bangkok: "img/Thailand.jpg",
        Vancouver: "img/vancouver.jpg",
        Bologna: "img/Bologna.jpg",
        Bordeaux: "img/Bordeaux.jpg",
        Florenz: "img/Florenz.jpg",
        Glasgow: "img/Glasgow.jpg",
        Granada: "img/Granada.jpg",
        Ibiza: "img/Ibiza.jpg",
        Liverpool: "img/Liverpool.jpg",
        London: "img/London.jpg",
        Madrid: "img/Madrid.jpg",
        Mailand: "img/Mailand.jpg",
        Malaga: "img/Malaga.jpg",
        Manchester: "img/Manchester.jpg",
        Marseille: "img/Marseille.jpg",
        Neapel: "img/Neapel.jpg",
        Nizza: "img/Nizza.jpg",
        Palma: "img/Palma.jpg",
        Sevilla: "img/Sevilla.jpg",
        Toulouse: "img/Toulouse.jpg",
        Turin: "img/Turin.jpg",
        Valencia: "img/Valencia.jpg",
        Venedig: "img/Venedig.jpg",
        Verona: "img/Verona.jpg"
      };

      return localImages[destination] || "img/bali.jpg";
    }
    
    function generateOffers() {
      console.log('Generating offers, destinations length:', destinations.length);
      const offers = [];
      
      // Tour types with logical group sizes
      const tourTypes = [
        { type: 'couples', name: '💕 Für Paare', minPersons: 2, maxPersons: 2, icon: '💕' },
        { type: 'family-kids', name: '👨‍👩‍👧‍👦 Familie mit Kindern', minPersons: 3, maxPersons: 5, icon: '👨‍👩‍👧‍👦' },
        { type: 'family-no-kids', name: '👫 Familie ohne Kinder', minPersons: 2, maxPersons: 2, icon: '👫' },
        { type: 'friends', name: '👥 Freunde', minPersons: 3, maxPersons: 6, icon: '👥' },
        { type: 'solo', name: '🧳 Alleinreisende', minPersons: 1, maxPersons: 1, icon: '🧳' }
      ];
      
      // Cities suitable for different tour types
      const cityTourTypes = {
        'Paris': ['couples', 'family-no-kids'],
        'Venedig': ['couples', 'family-no-kids'],
        'Santorini': ['couples', 'family-no-kids'],
        'Malediven': ['couples', 'family-no-kids'],
        'Bali': ['couples', 'friends', 'solo'],
        'Barcelona': ['family-kids', 'friends', 'couples'],
        'London': ['family-kids', 'friends', 'solo'],
        'New York': ['friends', 'solo', 'couples'],
        'Dubai': ['family-kids', 'couples', 'friends'],
        'Bangkok': ['friends', 'solo', 'couples'],
        'Sydney': ['family-kids', 'friends', 'couples'],
        'Kyoto': ['couples', 'solo', 'family-no-kids'],
        'Ibiza': ['friends', 'couples'],
        'Madrid': ['family-kids', 'friends', 'couples'],
        'Florenz': ['couples', 'family-no-kids', 'solo'],
        'Lissabon': ['couples', 'friends', 'family-no-kids'],
        'Edinburgh': ['couples', 'friends', 'solo'],
        'Reykjavik': ['couples', 'friends', 'solo'],
        'Vancouver': ['family-kids', 'friends', 'couples'],
        'Kapstadt': ['friends', 'couples', 'solo']
      };
      
      // Other cities get random tour types
      const allCities = [
        {city: 'Bali', country: 'Indonesien'},
        {city: 'Barcelona', country: 'Spanien'},
        {city: 'Kapstadt', country: 'Südafrika'},
        {city: 'Dubai', country: 'VAE'},
        {city: 'Edinburgh', country: 'Großbritannien'},
        {city: 'Reykjavik', country: 'Island'},
        {city: 'Kyoto', country: 'Japan'},
        {city: 'Lissabon', country: 'Portugal'},
        {city: 'Malediven', country: 'Malediven'},
        {city: 'Marrakesch', country: 'Marokko'},
        {city: 'New York', country: 'USA'},
        {city: 'Paris', country: 'Frankreich'},
        {city: 'Santorini', country: 'Griechenland'},
        {city: 'Sydney', country: 'Australien'},
        {city: 'Bangkok', country: 'Thailand'},
        {city: 'Vancouver', country: 'Kanada'},
        {city: 'Bologna', country: 'Italien'},
        {city: 'Bordeaux', country: 'Frankreich'},
        {city: 'Florenz', country: 'Italien'},
        {city: 'Glasgow', country: 'Großbritannien'},
        {city: 'Granada', country: 'Spanien'},
        {city: 'Ibiza', country: 'Spanien'},
        {city: 'Liverpool', country: 'Großbritannien'},
        {city: 'London', country: 'Großbritannien'},
        {city: 'Madrid', country: 'Spanien'},
        {city: 'Mailand', country: 'Italien'},
        {city: 'Malaga', country: 'Spanien'},
        {city: 'Manchester', country: 'Großbritannien'},
        {city: 'Marseille', country: 'Frankreich'},
        {city: 'Neapel', country: 'Italien'},
        {city: 'Nizza', country: 'Frankreich'},
        {city: 'Palma', country: 'Spanien'},
        {city: 'Sevilla', country: 'Spanien'},
        {city: 'Toulouse', country: 'Frankreich'},
        {city: 'Turin', country: 'Italien'},
        {city: 'Valencia', country: 'Spanien'},
        {city: 'Venedig', country: 'Italien'},
        {city: 'Verona', country: 'Italien'}
      ];
      
      let offerId = 1;
      
      // Create offers for each city
      allCities.forEach((dest, index) => {
        // Determine suitable tour types for the city
        const suitableTourTypes = cityTourTypes[dest.city] || 
          [tourTypes[Math.floor(Math.random() * tourTypes.length)].type, 
           tourTypes[Math.floor(Math.random() * tourTypes.length)].type];
        
        // Create 2-3 offers for each suitable type
        suitableTourTypes.forEach(tourTypeKey => {
          const tourType = tourTypes.find(t => t.type === tourTypeKey);
          if (!tourType) return;
          
          for (let i = 0; i < 2; i++) {
            // Random departure dates (7 to 180 days out)
            const departureDate = new Date();
            departureDate.setDate(departureDate.getDate() + Math.floor(Math.random() * 173) + 7);
            
            // Random duration (3-14 days)
            const days = [3, 5, 7, 10, 14][Math.floor(Math.random() * 5)];
            
            // End date
            const endDate = new Date(departureDate);
            endDate.setDate(endDate.getDate() + days);
            
            // Random number of people within tour type range
            const persons = Math.floor(Math.random() * (tourType.maxPersons - tourType.minPersons + 1)) + tourType.minPersons;
            
            // Price depends on tour type and number of days
            const basePrice = [299, 459, 699, 899, 1299][Math.floor(Math.random() * 5)];
            const pricePerPerson = Math.floor(basePrice + (days * 20) + Math.random() * 200);
            
            const img = getImageForDestination(dest.city);

            // Determine card type for variety
            let cardType = 'regular';
            if ((offerId - 1) % 7 === 0) cardType = 'featured'; // Every 7th offer
            else if ((offerId - 1) % 5 === 0) cardType = 'compact'; // Every 5th offer
            else if ((offerId - 1) % 3 === 0) cardType = 'wide'; // Every 3rd offer

            offers.push({
              id: offerId++,
              city: dest.city,
              country: dest.country,
              destination: dest.city + ', ' + dest.country,
              airport: airports[Math.floor(Math.random() * airports.length)],
              price: pricePerPerson,
              days: days,
              persons: persons,
              tourType: tourType.type,
              tourTypeName: tourType.name,
              tourTypeIcon: tourType.icon,
              departureDate: departureDate.toLocaleDateString('de-DE'),
              endDate: endDate.toLocaleDateString('de-DE'),
              departureDateObj: departureDate,
              endDateObj: endDate,
              img,
              rating: (4.0 + Math.random() * 1.0).toFixed(1),
              cardType: cardType
            });
          }
        });
      });
      
      console.log('Generated offers:', offers.length);
      return offers;
    }

    let allOffers = generateOffers();
    let filteredOffers = [...allOffers];

    function renderOffers(offers) {
      const container = document.getElementById('offersContainer');
      if (!container) {
        console.error('offersContainer not found');
        return;
      }
      console.log('Rendering offers:', offers.length);
      container.innerHTML = offers.map(offer => {
        let colClasses = 'col-lg-3 col-md-4 col-sm-6 mb-4';
        let cardClasses = 'offer-item';
        let additionalElements = '';
        let extraInfo = '';

        if (offer.cardType === 'featured') {
          cardClasses += ' featured-card';
          additionalElements += '<div class="featured-badge"><i class="bi bi-star-fill"></i> Top Deal</div>';
        } else if (offer.cardType === 'compact') {
          cardClasses += ' compact-card';
        } else if (offer.cardType === 'wide') {
          cardClasses += ' wide-card';
          additionalElements += '<div class="discount-badge"><i class="bi bi-percent"></i> Sparen</div>';
        }

        return `
        <div class="${colClasses}">
          <div class="${cardClasses}">
            <div style="position: relative;">
              <img src="${offer.img}" class="offer-img" alt="${offer.destination}">
              <div class="price-badge">${offer.price}€</div>
              ${additionalElements}
            </div>
            <div class="p-3">
              <h5 class="mb-2"><i class="bi bi-geo-alt-fill me-1" style="color: #667eea;"></i>${offer.city}</h5>
              <span class="country-badge"><i class="bi bi-flag me-1"></i>${offer.country}</span>
              ${extraInfo}
              <div class="mt-2 mb-2">
                <span class="badge" style="background: linear-gradient(135deg, #43e97b, #38f9d7); color: white; font-size: 0.7rem; padding: 0.3rem 0.6rem; border-radius: 12px;">
                  ${offer.tourTypeName}
                </span>
              </div>
              <p class="mb-1 text-muted"><i class="bi bi-people-fill me-2"></i>${offer.persons} ${offer.persons === 1 ? 'Person' : 'Personen'}</p>
              <p class="mb-1 text-muted"><i class="bi bi-airplane-fill me-2"></i>Ab ${offer.airport}</p>
              <p class="mb-1 text-muted"><i class="bi bi-calendar-event me-2"></i>${offer.departureDate} - ${offer.endDate}</p>
              <p class="mb-2 text-muted"><i class="bi bi-clock me-2"></i>${offer.days} Tage</p>
              <div class="d-flex gap-2">
                <button class="btn btn-details w-50 btn-sm" onclick="showOfferDetails(${offer.id})">
                  <i class="bi bi-info-circle"></i><span class="d-none d-md-inline ms-1">Details</span>
                </button>
                <button class="btn btn-primary w-50 btn-sm" onclick="bookOffer(${offer.id})">
                  <i class="bi bi-cart-plus me-1"></i><span class="d-none d-md-inline">Jetzt buchen</span>
                </button>
              </div>
            </div>
          </div>
        </div>
      `;
      }).join('');
    }

    function applyFilters() {
      const minPrice = parseInt(document.getElementById('minPrice').value) || 0;
      const maxPrice = parseInt(document.getElementById('maxPrice').value) || 3000;
      const airport = document.getElementById('airportFilter').value;
      const tourType = document.getElementById('tourTypeFilter').value;
      const searchTerm = document.getElementById('destinationFilter').value.toLowerCase();
      const sort = document.getElementById('sortFilter').value;

      filteredOffers = allOffers.filter(offer => {
        const priceMatch = offer.price >= minPrice && offer.price <= maxPrice;
        const airportMatch = !airport || offer.airport === airport;
        const tourTypeMatch = !tourType || offer.tourType === tourType;
        const destMatch = !searchTerm || 
                         offer.city.toLowerCase().includes(searchTerm) || 
                         offer.country.toLowerCase().includes(searchTerm);
        return priceMatch && airportMatch && tourTypeMatch && destMatch;
      });

      if (sort === 'price-asc') {
        filteredOffers.sort((a, b) => a.price - b.price);
      } else if (sort === 'price-desc') {
        filteredOffers.sort((a, b) => b.price - a.price);
      } else if (sort === 'date-asc') {
        filteredOffers.sort((a, b) => a.departureDateObj - b.departureDateObj);
      }

      renderOffers(filteredOffers);
      document.getElementById('resultsCount').textContent = filteredOffers.length;
    }

    // Quick booking: open details modal and prefill booking modal
    function openBookingQuick(id) {
      const offer = allOffers.find(o => o.id === id);
      if (!offer) return showToast('Angebot nicht gefunden', 'error');
      showOfferDetails(id);
      // prefill booking modal values (small delay to ensure details rendered)
      setTimeout(() => {
        const price = offer.price;
        const detailPriceEls = document.querySelectorAll('#detailPrice, #detailPrice2, #detailPrice3');
        detailPriceEls.forEach(el => { if (el) el.textContent = price; });
        const bookBtn = document.getElementById('bookOfferBtn');
        if (bookBtn) bookBtn.onclick = () => {
          // open booking modal
          const bookingModal = new bootstrap.Modal(document.getElementById('bookingModal'));
          document.getElementById('bookingOfferTitle').textContent = offer.title || offer.city;
          document.getElementById('bookingTotalPrice').textContent = price;
          bookingModal.show();
        };
      }, 120);
    }

    function showOfferDetails(id) {
      const offer = allOffers.find(o => o.id === id);
      const descriptions = [
        `Entdecken Sie ${offer.city} - eine Stadt voller Geschichte und Charme. Erleben Sie ${offer.days} unvergessliche Tage mit erstklassigen Hotels, lokaler Küche und kulturellen Highlights. Perfekt für ${offer.persons} ${offer.persons === 1 ? 'Person' : 'Personen'}.`,
        `Tauchen Sie ein in die faszinierende Welt von ${offer.city}. Diese ${offer.days}-tägige Reise bietet Ihnen authentische Erlebnisse, moderne Annehmlichkeiten und unvergessliche Momente für ${offer.persons} ${offer.persons === 1 ? 'Person' : 'Personen'}.`,
        `${offer.city} erwartet Sie! Genießen Sie ${offer.days} Tage voller Abenteuer, Entspannung und kultureller Entdeckungen in einer der schönsten Destinationen. Ideal für ${offer.persons} ${offer.persons === 1 ? 'Person' : 'Personen'}.`,
        `Erleben Sie die Magie von ${offer.city}. Ihre ${offer.days}-tägige Traumreise umfasst komfortable Unterkünfte, spannende Ausflüge und lokale Gastronomie für ${offer.persons} ${offer.persons === 1 ? 'Person' : 'Personen'}.`,
        `Willkommen in ${offer.city}! Diese ${offer.days}-tägige Reise kombiniert Sightseeing, Erholung und authentische Begegnungen mit Land und Leuten. Perfekt für ${offer.persons} ${offer.persons === 1 ? 'Person' : 'Personen'}.`
      ];
      const hotels = [
        'Grand Palace Hotel',
        'Seaside Resort & Spa',
        'Urban Boutique Hotel',
        'Mountain View Lodge',
        'Luxury City Center',
        'Tropical Paradise Resort',
        'Historic Heritage Inn',
        'Modern Skyline Hotel',
        'Garden Oasis Resort',
        'Coastal Breeze Hotel'
      ];
      const descIndex = id % descriptions.length;
      const hotelIndex = id % hotels.length;
      document.getElementById('detailCity').textContent = offer.city;
      document.getElementById('detailCountry').textContent = offer.country;
      document.getElementById('detailImage').src = offer.img;
      document.getElementById('detailImage').alt = offer.city;
      document.getElementById('detailPrice').textContent = offer.price;
      document.getElementById('detailPrice2').textContent = offer.price;
      document.getElementById('detailPrice3').textContent = offer.price;
      document.getElementById('detailAirport').textContent = offer.airport;
      document.getElementById('detailRating').textContent = offer.rating;
      document.getElementById('detailHotel').textContent = hotels[hotelIndex];
      document.getElementById('detailDescription').textContent = descriptions[descIndex];
      document.getElementById('bookOfferBtn').onclick = () => bookOffer(id);
      new bootstrap.Modal(document.getElementById('offerDetailModal')).show();
    }
    
    let currentBookingOffer = null;
    
    window.bookOffer = function(id) {
      console.log('bookOffer called with id:', id);
      currentBookingOffer = allOffers.find(o => o.id === id);
      console.log('Found offer:', currentBookingOffer);
      
      if (!currentBookingOffer) {
        showToast('Angebot nicht gefunden!', 'error');
        return;
      }
      
      const detailModal = bootstrap.Modal.getInstance(document.getElementById('offerDetailModal'));
      if (detailModal) detailModal.hide();
      
      setTimeout(() => {
        const titleEl = document.getElementById('bookingOfferTitle');
        const totalPriceEl = document.getElementById('bookingTotalPrice');
        const destinationEl = document.getElementById('bookingDestination');
        const personsEl = document.getElementById('bookingPersons');
        const durationEl = document.getElementById('bookingDuration');
        const airportEl = document.getElementById('bookingAirport');
        
        if (!titleEl || !totalPriceEl) {
          console.error('Booking modal elements not found');
          return;
        }
        
        titleEl.textContent = currentBookingOffer.city;
        totalPriceEl.textContent = currentBookingOffer.price * currentBookingOffer.persons;
        if (destinationEl) destinationEl.textContent = currentBookingOffer.city + ', ' + currentBookingOffer.country;
        if (personsEl) personsEl.textContent = currentBookingOffer.persons;
        if (durationEl) durationEl.textContent = currentBookingOffer.days + ' Tage';
        if (airportEl) airportEl.textContent = currentBookingOffer.airport;
        
        generateTravelerForms(currentBookingOffer.persons);
        
        const bookingModal = new bootstrap.Modal(document.getElementById('bookingModal'));
        bookingModal.show();
      }, 300);
    }
    
    function generateTravelerForms(personCount) {
      const container = document.getElementById('travelersContainer');
      if (!container) return;

      container.innerHTML = '';
      for (let i = 1; i <= personCount; i++) {
        container.innerHTML += `
          <div class="card mb-3" style="border: 2px solid #e0e0e0; border-radius: 15px;">
            <div class="card-header" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 1rem;">
              <strong><i class="bi bi-person-fill me-2"></i>Person ${i}</strong>
            </div>
            <div class="card-body" style="padding: 1.5rem;">
              <div class="row g-3">
                <div class="col-md-2">
                  <label class="form-label fw-semibold"><i class="bi bi-person-badge me-1"></i>Anrede</label>
                  <select class="form-control form-control-lg" id="anrede${i}" required>
                    <option value="">Bitte wählen</option>
                    <option value="Herr">Herr</option>
                    <option value="Frau">Frau</option>
                  </select>
                </div>
                <div class="col-md-5">
                  <label class="form-label fw-semibold"><i class="bi bi-person me-1"></i>Vorname</label>
                  <input type="text" class="form-control form-control-lg" id="vorname${i}" placeholder="Max" required>
                </div>
                <div class="col-md-5">
                  <label class="form-label fw-semibold"><i class="bi bi-person me-1"></i>Nachname</label>
                  <input type="text" class="form-control form-control-lg" id="nachname${i}" placeholder="Mustermann" required>
                </div>
                <div class="col-md-4">
                  <label class="form-label fw-semibold"><i class="bi bi-calendar-event me-1"></i>Geburtsdatum</label>
                  <input type="date" class="form-control form-control-lg" id="geburtsdatum${i}" required>
                </div>
                <div class="col-md-4">
                  <label class="form-label fw-semibold"><i class="bi bi-flag me-1"></i>Land</label>
                  <select class="form-control form-control-lg" id="land${i}" required>
                    <option value="">Bitte wählen</option>
                    <option value="Deutschland">🇩🇪 Deutschland</option>
                    <option value="Österreich">🇦🇹 Österreich</option>
                    <option value="Schweiz">🇨🇭 Schweiz</option>
                    <option value="Frankreich">🇫🇷 Frankreich</option>
                    <option value="Italien">🇮🇹 Italien</option>
                    <option value="Spanien">🇪🇸 Spanien</option>
                    <option value="Niederlande">🇳🇱 Niederlande</option>
                    <option value="Belgien">🇧🇪 Belgien</option>
                    <option value="Luxemburg">🇱🇺 Luxemburg</option>
                    <option value="Dänemark">🇩🇰 Dänemark</option>
                    <option value="Schweden">🇸🇪 Schweden</option>
                    <option value="Norwegen">🇳🇴 Norwegen</option>
                    <option value="Finnland">🇫🇮 Finnland</option>
                    <option value="Polen">🇵🇱 Polen</option>
                    <option value="Tschechien">🇨🇿 Tschechien</option>
                    <option value="Ungarn">🇭🇺 Ungarn</option>
                    <option value="Slowakei">🇸🇰 Slowakei</option>
                    <option value="Slowenien">🇸🇮 Slowenien</option>
                    <option value="Kroatien">🇭🇷 Kroatien</option>
                    <option value="Rumänien">🇷🇴 Rumänien</option>
                    <option value="Bulgarien">🇧🇬 Bulgarien</option>
                    <option value="Griechenland">🇬🇷 Griechenland</option>
                    <option value="Portugal">🇵🇹 Portugal</option>
                    <option value="Irland">🇮🇪 Irland</option>
                    <option value="Vereinigtes Königreich">🇬🇧 Vereinigtes Königreich</option>
                  </select>
                </div>
                <div class="col-md-4">
                  <label class="form-label fw-semibold"><i class="bi bi-passport me-1"></i>Reisepass Nr.</label>
                  <input type="text" class="form-control form-control-lg" id="reisepass${i}" placeholder="A123456789" required>
                </div>
              </div>
            </div>
          </div>`;
      }
    }
    
    function toggleBillingData() {
      const checkbox = document.getElementById('copyFromTraveler1');
      const container = document.getElementById('billingDataContainer');
      
      if (checkbox.checked) {
        // Copy data from first traveler
        document.getElementById('billingAnrede').value = document.getElementById('anrede1').value;
        document.getElementById('billingVorname').value = document.getElementById('vorname1').value;
        document.getElementById('billingNachname').value = document.getElementById('nachname1').value;
        document.getElementById('billingGeburtsdatum').value = document.getElementById('geburtsdatum1').value;
        container.style.opacity = '0.5';
        container.style.pointerEvents = 'none';
      } else {
        container.style.opacity = '1';
        container.style.pointerEvents = 'auto';
      }
    }
    
    window.proceedToPayment = function() {
      bootstrap.Modal.getInstance(document.getElementById('bookingModal')).hide();
      setTimeout(() => new bootstrap.Modal(document.getElementById('paymentModal')).show(), 300);
    }
    
    window.completePayment = function() {
      const method = document.querySelector('input[name="paymentMethod"]:checked')?.value;
      if (!method) { showToast('Bitte Zahlungsmethode wählen', 'warning'); return; }
      // Validate the form
      if (method === 'card') {
        const name = document.getElementById('cardName').value.trim();
        const number = document.getElementById('cardNumber').value.trim();
        const expiry = document.getElementById('cardExpiry').value.trim();
        const cvv = document.getElementById('cardCvv').value.trim();
        if (!name || !number || !expiry || !cvv) {
          showToast('Bitte füllen Sie alle Kreditkartendaten aus', 'warning');
          return;
        }
      } else if (method === 'paypal') {
        const email = document.getElementById('paypalEmail').value.trim();
        if (!email) {
          showToast('Bitte geben Sie Ihre PayPal E-Mail ein', 'warning');
          return;
        }
      } else if (method === 'bank') {
        const name = document.getElementById('bankName').value.trim();
        const iban = document.getElementById('bankIban').value.trim();
        const bic = document.getElementById('bankBic').value.trim();
        if (!name || !iban || !bic) {
          showToast('Bitte füllen Sie alle Bankdaten aus', 'warning');
          return;
        }
      }
      showToast('Zahlung erfolgreich! Buchung abgeschlossen.', 'success');
      bootstrap.Modal.getInstance(document.getElementById('paymentModal')).hide();
    }

    function showPaymentForm(type) {
      ['card', 'paypal', 'bank'].forEach(t => {
        document.getElementById(t + 'Form').style.display = 'none';
      });
      if (type) {
        document.getElementById(type + 'Form').style.display = 'block';
        if (type === 'bank' && currentBookingOffer) {
          // Generate random IBAN
          const checksum = Math.floor(Math.random() * 100).toString().padStart(2, '0');
          const account = Math.floor(Math.random() * 10**18).toString().padStart(18, '0');
          const iban = 'DE' + checksum + account;
          document.getElementById('bankIban').value = iban;

          // Generate description
          const description = 'Reise nach ' + currentBookingOffer.city + ' - Buchung #' + currentBookingOffer.id;
          document.getElementById('bankDescription').value = description;
        }
      }
    }



    document.getElementById('minPrice').addEventListener('input', applyFilters);
    document.getElementById('maxPrice').addEventListener('input', applyFilters);
    document.getElementById('airportFilter').addEventListener('change', applyFilters);
    document.getElementById('tourTypeFilter').addEventListener('change', applyFilters);
    document.getElementById('destinationFilter').addEventListener('input', applyFilters);
    document.getElementById('sortFilter').addEventListener('change', applyFilters);

    const urlParams = new URLSearchParams(window.location.search);
    const searchDest = urlParams.get('destination');
    const searchAirport = urlParams.get('airport');
    
    if (searchDest) {
      document.getElementById('destinationFilter').value = searchDest;
    }
    if (searchAirport) {
      const airportMap = {
        'VIE': 'Wien',
        'SZG': 'Salzburg',
        'INN': 'Innsbruck',
        'GRZ': 'Graz',
        'LNZ': 'Linz',
        'KLU': 'Klagenfurt'
      };
      document.getElementById('airportFilter').value = airportMap[searchAirport] || searchAirport;
    }
    
    if (searchDest || searchAirport) {
      applyFilters();
    }
    
    // Auto-apply filters on page load
    document.addEventListener('DOMContentLoaded', function() {
      console.log('Initializing offers, total:', allOffers.length);
      applyFilters();
      console.log('Filtered offers:', filteredOffers.length);

      // Update billing land options with flags
      const billingLand = document.getElementById('billingLand');
      if (billingLand) {
        billingLand.innerHTML = `
          <option value="">Bitte wählen</option>
          <option value="Deutschland">🇩🇪 Deutschland</option>
          <option value="Österreich">🇦🇹 Österreich</option>
          <option value="Schweiz">🇨🇭 Schweiz</option>
          <option value="Frankreich">🇫🇷 Frankreich</option>
          <option value="Italien">🇮🇹 Italien</option>
          <option value="Spanien">🇪🇸 Spanien</option>
          <option value="Niederlande">🇳🇱 Niederlande</option>
          <option value="Belgien">🇧🇪 Belgien</option>
          <option value="Luxemburg">🇱🇺 Luxemburg</option>
          <option value="Dänemark">🇩🇰 Dänemark</option>
          <option value="Schweden">🇸🇪 Schweden</option>
          <option value="Norwegen">🇳🇴 Norwegen</option>
          <option value="Finnland">🇫🇮 Finnland</option>
          <option value="Polen">🇵🇱 Polen</option>
          <option value="Tschechien">🇨🇿 Tschechien</option>
          <option value="Ungarn">🇭🇺 Ungarn</option>
          <option value="Slowakei">🇸🇰 Slowakei</option>
          <option value="Slowenien">🇸🇮 Slowenien</option>
          <option value="Kroatien">🇭🇷 Kroatien</option>
          <option value="Rumänien">🇷🇴 Rumänien</option>
          <option value="Bulgarien">🇧🇬 Bulgarien</option>
          <option value="Griechenland">🇬🇷 Griechenland</option>
          <option value="Portugal">🇵🇹 Portugal</option>
          <option value="Irland">🇮🇪 Irland</option>
          <option value="Vereinigtes Königreich">🇬🇧 Vereinigtes Königreich</option>
        `;
      }
    });
    

  </script>
  <script>
    async function loadProfile() {
      const user = await window.DB.getUser();
      if (!user) return;
      const initials = (user.firstname?.charAt(0) || 'U') + (user.lastname?.charAt(0) || 'U');
      document.getElementById('profileAvatar').textContent = initials;
      document.getElementById('profileFullName').textContent = (user.firstname || '') + ' ' + (user.lastname || '');
      document.getElementById('profileEmail').textContent = user.email || '';
      document.getElementById('profileFirstName').textContent = user.firstname || '';
      document.getElementById('profileLastName').textContent = user.lastname || '';
      document.getElementById('profilePhone').textContent = user.phone || 'Nicht angegeben';
      document.getElementById('profileAddress').textContent = user.address || 'Nicht angegeben';
      document.getElementById('profileDatum').textContent = user.created_at ? new Date(user.created_at).toLocaleDateString('de-DE') : 'Heute';
      const buchungen = await window.DB.getUserBookings();
      document.getElementById('profileBuchungen').innerHTML = buchungen.length ? buchungen.map(b => `<div class="p-2 bg-light rounded mb-2"><strong>${b.title || 'Buchung'}</strong></div>`).join('') : '<p class="text-muted">Noch keine Buchungen</p>';
    }
    
    document.getElementById('editProfileBtn')?.addEventListener('click', function() {
      document.getElementById('profileView').style.display = 'none';
      document.getElementById('profileEdit').style.display = 'block';
      this.style.display = 'none';
      const user = JSON.parse(localStorage.getItem('currentUser') || '{}');
      document.getElementById('editFirstName').value = user.firstname || '';
      document.getElementById('editLastName').value = user.lastname || '';
      document.getElementById('editPhone').value = user.phone || '';
      document.getElementById('editAddress').value = user.address || '';
    });
    
    document.getElementById('cancelEditBtn')?.addEventListener('click', function() {
      document.getElementById('profileView').style.display = 'block';
      document.getElementById('profileEdit').style.display = 'none';
      document.getElementById('editProfileBtn').style.display = 'inline-block';
    });
    
    document.getElementById('profileEditForm')?.addEventListener('submit', async function(e) {
      e.preventDefault();
      await window.DB.updateProfile({
        firstname: document.getElementById('editFirstName').value,
        lastname: document.getElementById('editLastName').value,
        phone: document.getElementById('editPhone').value,
        address: document.getElementById('editAddress').value
      });
      document.getElementById('profileView').style.display = 'block';
      document.getElementById('profileEdit').style.display = 'none';
      document.getElementById('editProfileBtn').style.display = 'inline-block';
      loadProfile();
      if (typeof updateNavigation === 'function') {
        await updateNavigation();
      }
      alert('✅ Profil aktualisiert!');
    });

    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById('loginForm')?.addEventListener('submit', async function(e) {
        e.preventDefault();
        const email = document.getElementById('loginEmail').value.trim();
        const password = document.getElementById('loginPassword').value;
        if (!email || !password) { alert('❌ Bitte füllen Sie alle Felder aus'); return; }
        await window.DB.signIn(email, password);
        bootstrap.Modal.getInstance(document.getElementById('loginModal')).hide();
        this.reset();
        setTimeout(async () => { 
          if (typeof updateNavigation === 'function') {
            await updateNavigation(); 
          }
          alert('✅ Erfolgreich angemeldet!'); 
        }, 500);
      });

      document.getElementById('registerForm')?.addEventListener('submit', async function(e) {
        e.preventDefault();
        console.log('Registration form submitted');
        const email = document.getElementById('regEmail').value.trim();
        const password = document.getElementById('regPassword').value;
        const passwordConfirm = document.getElementById('regPasswordConfirm').value;
        const firstname = document.getElementById('regFirstName').value.trim();
        const lastname = document.getElementById('regLastName').value.trim();
        console.log('Form values:', {email, firstname, lastname, passwordLength: password.length});
        if (!email || !password || !firstname || !lastname) { alert('❌ Bitte füllen Sie alle Felder aus'); return; }
        if (password !== passwordConfirm) { alert('❌ Passwörter stimmen nicht überein'); return; }
        if (password.length < 6) { alert('❌ Passwort muss mindestens 6 Zeichen haben'); return; }
        try {
          console.log('Calling DB.signUp...');
          await window.DB.signUp(email, password, firstname, lastname);
          console.log('DB.signUp completed successfully');
          bootstrap.Modal.getInstance(document.getElementById('registerModal')).hide();
          this.reset();
          setTimeout(async () => {
            if (typeof updateNavigation === 'function') {
              await updateNavigation();
            }
            alert('✅ Konto erfolgreich erstellt!');
          }, 300);
        } catch (error) {
          console.error('Registration error:', error);
          showToast('Registrierung fehlgeschlagen: ' + (error.message || 'Unbekannter Fehler'), 'error');
        }
      });
    });

    window.DB = {
      async getUser() {
        const user = localStorage.getItem('currentUser');
        return user ? JSON.parse(user) : null;
      },
      async getUserProfile() {
        return this.getUser();
      },
      async signOut() {
        localStorage.removeItem('currentUser');
      },
      async signUp(email, password, firstname, lastname) {
        console.log('DB.signUp called with:', {email, firstname, lastname});
        const user = { email, firstname, lastname, created_at: new Date().toISOString() };
        console.log('Creating user:', user);
        localStorage.setItem('currentUser', JSON.stringify(user));
        localStorage.setItem('user_' + email, JSON.stringify(user));
        console.log('User saved to localStorage');
        return { user };
      },
      async signIn(email, password) {
        const savedUser = localStorage.getItem('user_' + email);
        const user = savedUser ? JSON.parse(savedUser) : { email };
        localStorage.setItem('currentUser', JSON.stringify(user));
        return { user };
      },
      async getUserBookings() {
        return [];
      },
      async updateProfile(profileData) {
        const user = await this.getUser();
        if (user) {
          Object.assign(user, profileData);
          localStorage.setItem('currentUser', JSON.stringify(user));
          if (user.email) {
            localStorage.setItem('user_' + user.email, JSON.stringify(user));
          }
        }
        return user;
      }
    };

    // Navigation
    async function updateNavigation() {
      console.log('updateNavigation called');
      const navLogin = document.getElementById('navLogin');
      const navRegister = document.getElementById('navRegister');
      const navUser = document.getElementById('navUser');
      const navUserName = document.getElementById('navUserName');
      
      if (!navLogin || !navRegister || !navUser) {
        console.log('Nav elements not found');
        return;
      }
      
      try {
        const user = await window.DB.getUser();
        console.log('Current user:', user);
        
        if (user) {
          navLogin.style.display = 'none';
          navRegister.style.display = 'none';
          navUser.style.display = 'block';
          if (navUserName) {
            navUserName.textContent = (user.firstname || '') + ' ' + (user.lastname || '');
          }
          console.log('User navigation updated');
        } else {
          navLogin.style.display = 'block';
          navRegister.style.display = 'block';
          navUser.style.display = 'none';
          console.log('Guest navigation updated');
        }
      } catch (error) {
        console.error('Nav error:', error);
        navLogin.style.display = 'block';
        navRegister.style.display = 'block';
        navUser.style.display = 'none';
      }
    }

    async function logout() {
      if (confirm('Möchten Sie sich wirklich abmelden?')) {
        try {
          await window.DB.signOut();
        } catch (error) {
          console.error('Logout error:', error);
        }
        window.location.href = 'index.html';
      }
    }

    // Call immediately
    updateNavigation();
  </script>
</body>
</html>
